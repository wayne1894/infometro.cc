<div id="line_parent">
	<div id="logo"><img class="logo" src="src/static/images/logo_200.png"></div>
	<div id="left_line">
	<div class="line_text"><span>主線：</span>
<!--  <i class="circular inverted orange info loading icon"></i>-->
  </div>
	  <ul id="line_drag_master">
	    <li v-for="(item, index) in line" v-if="item.master" :class="check_line(index)" class="line_list" @drop="drop_line(event,index)">
       	 <input class="line_input" type="text" v-model="item.name">
	       <i class="line_i" :style="{backgroundColor:item.color}" @click="exchange_line(index)" @dblclick="open_color(index,item.color,'master')" ></i>
	       <a class="line_a" @dblclick="re_name(index,'line')"  @click="exchange_line(index)">{{item.name}}</a>
	    </li>
	  </ul>
	<div class="line_text">一般支線：</div>
      <ul id="line_drag">
        <li v-for="(item, index) in line" v-show="!item.master" :class="check_line(index)"   class="line_list" @drop="drop_line(event,index)" :data-key="item._key" :key="item._key">
          <div v-if="!item.master" class="tool" @click="delete_line(index)">
            <i class="trash outline mini small icon"></i>
          </div>
          <input v-if="!item.master" class="line_input" type="text" v-model="item.name">
          <i v-if="!item.master" class="line_i" @dblclick="open_color(index,item.color)" @click="exchange_line(index)" :style="{backgroundColor:item.color}" ></i>
          <a v-if="!item.master" class="line_a" @dblclick="re_name(index,'line')" @click="exchange_line(index)">{{item.name}}</a>
        </li>
      </ul>
	</div>
	<a id="new_line" class="default_a" @click="new_line()">新增支線</a>
</div>
<div id="edit_parent">
	<a class="left_icon" data-tooltip="切換導覽"  data-position="right center"><i class="help circle icon"></i></a>
	<a class="left_icon" data-tooltip="登出"  data-position="right center" onclick="登出()"><i class="power icon"></i></a>
</div>


<script>
  function drop_line(event,index){
    var metro_index = event.dataTransfer.getData("index");
    
	if(metro_index=="")return;
    var _metro=vm.move_metro(metro_index,index);
    
    if(_metro==undefined)return
    _metro=_metro[0];
    vm.get_blueprint().line[index].metro.push(_metro);
    vm.更新藍圖();
  }
    
$(function(){
  $(document.body).append("<div id='left_color' style='position: absolute;left:0;top:0'></div>");
  $('#left_color').colpick({
    layout:'hex',
    onHide:function(){
      vm.pick_master=undefined;
      vm.pick_color=undefined;
    },
    onChange:function(hsb,hex,rgb,el,bySetColor){
      vm.pick_color="#"+hex;
    },
    onSubmit:function(hsb,hex,rgb,el,bySetColor){
      $(el).val(hex);
      $(el).colpickHide();
    }
  }).colpickHide();
})
</script>